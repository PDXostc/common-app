PROJECT = DNA_Browser
INSTALL_FILES = images js icon.png index.html
WRT_FILES = DNA_common config.xml css error.html icon.png images index.html js search.html  templates warning.html
VERSION := 0.0.1
PACKAGE = $(PROJECT)-$(VERSION)

INSTALL_DIR = $(DESTDIR)/opt/usr/apps/.preinstallWidgets

ifndef TIZEN_IP
TIZEN_IP=TizenNuc
endif

dev: clean dev-common
	zip -r $(PROJECT).wgt $(WRT_FILES)
	
$(PROJECT).wgt : dev

deploy: $(PROJECT).wgt
	scp $(PROJECT).wgt app@$(TIZEN_IP):/home/app

run: install
	ssh app@$(TIZEN_IP) "export DBUS_SESSION_BUS_ADDRESS='unix:path=/run/user/5000/dbus/user_bus_socket' && xwalkctl | egrep -e 'Browser' | awk '{print $1}' | xargs --no-run-if-empty xwalk-launcher"

install: deploy
	ssh app@$(TIZEN_IP) "export DBUS_SESSION_BUS_ADDRESS='unix:path=/run/user/5000/dbus/user_bus_socket' && xwalkctl | egrep -e 'Browser' | awk '{print $1}' | xargs --no-run-if-empty xwalkctl -u"
	ssh app@$(TIZEN_IP) "export DBUS_SESSION_BUS_ADDRESS='unix:path=/run/user/5000/dbus/user_bus_socket' && xwalkctl -i /home/app/DNA_Browser.wgt"

clean:
	rm $(PROJECT).wgt
	rm -rf DNA_common

DNA_common: /opt/usr/apps/DNA_common
	cp -r /opt/usr/apps/DNA_common/js/* js/
	cp -r /opt/usr/apps/DNA_common/css/* css/

deploy: dev
	scp $(PROJECT).wgt app@$(TIZEN_IP):/home/app

dev-common: ../DNA_common
	#cp -r ../common/js/* js/
	#cp -r ../common/css/* css/
	cp -rf ../DNA_common .

../DNA_common:
	@echo "Please checkout Common Assets"
	exit 1

